Starting scalable PGGCN job at Tue Aug  5 19:24:40 PDT 2025
Working directory: /home/lthoma21/BFE-Loss-Function/FINAL-PDBBIND-FILES
Python version: Python 3.10.11
Node: node06.cluster
System resources:
  CPUs: 8
  Memory: 251Gi
GPU information: nvidia-smi not available (using CPU)
Initial system memory usage:
              total        used        free      shared  buff/cache   available
Mem:          251Gi       3.8Gi       240Gi       452Mi       6.6Gi       245Gi
Swap:         4.0Gi          0B       4.0Gi
Starting scalable PGGCN training...
This version can handle 50+ structures with adaptive memory management
======================================================================
Starting PGGCN Scalable Training Script
======================================================================
Configuration:
  Dataset size: 10 structures
  Max padding: 3000 atoms
  Batch size: 2
  Epochs: 5
  Memory limit: 16 GB
  Initial memory usage: 0.65 GB
Loading data for 10 structures...
Memory limit: 16 GB
Selected 10 structures:
  complex-name        ddg
0         10gs  -8.841927
1         1a1e  -8.289306
2         1a30  -5.940670
3         1a4k -11.052408
4         1a4r  -9.201130
5         1a4w  -8.178782
6         1a69  -7.322221
7         1a94 -10.845176
8         1a99  -7.874841
9         1a9m  -9.560333
Filtered dataframe length: 10
Filtered PDBs count: 10
Current memory usage: 0.91 GB
Preparing features for 10 structures...
Processing in chunks of 10 for memory efficiency
Processing chunk 1/1: structures 1-10
  Processed 1/10: 10gs (3295 atoms)
  Processed 6/10: 1a4w (1964 atoms)
Dataset statistics:
  Max atoms: 10737
  Average atoms: 3745.3
  Max features: 53
  Total structures: 10
Current memory usage: 0.91 GB
Data split: 8 training, 2 testing

==================================================
Training with physics_weight: 2e-06
==================================================
Preparing training data with adaptive padding...
Original input shapes range: 1542 to 10737 atoms
Adaptive padding to 3000 atoms (actual max: 10737)
  Truncated structure 0 from 3000 to 3000 atoms
  Truncated structure 2 from 3000 to 3000 atoms
  Truncated structure 5 from 3000 to 3000 atoms
  Truncated structure 7 from 3000 to 3000 atoms
Training data shape: (8, 3000, 53)
Batch size: 2
Memory after training prep: 0.92 GB
Starting training with batch size 2...
Epoch 1/5
1/4 [======>.......................] - ETA: 10s - loss: 24.82662/4 [==============>...............] - ETA: 1s - loss: 51.3504 3/4 [=====================>........] - ETA: 0s - loss: 57.48164/4 [==============================] - ETA: 0s - loss: 58.8231Epoch 1: Memory usage: 1.73 GB
4/4 [==============================] - 5s 638ms/step - loss: 58.8231
Epoch 2/5
1/4 [======>.......................] - ETA: 1s - loss: 22.78932/4 [==============>...............] - ETA: 1s - loss: 26.50783/4 [=====================>........] - ETA: 0s - loss: 45.65834/4 [==============================] - ETA: 0s - loss: 39.96494/4 [==============================] - 3s 656ms/step - loss: 39.9649
Epoch 3/5
1/4 [======>.......................] - ETA: 1s - loss: 19.22832/4 [==============>...............] - ETA: 1s - loss: 25.22893/4 [=====================>........] - ETA: 0s - loss: 38.54294/4 [==============================] - ETA: 0s - loss: 51.10494/4 [==============================] - 3s 639ms/step - loss: 51.1049
Epoch 4/5
1/4 [======>.......................] - ETA: 1s - loss: 35.71422/4 [==============>...............] - ETA: 1s - loss: 22.95333/4 [=====================>........] - ETA: 0s - loss: 44.56934/4 [==============================] - ETA: 0s - loss: 46.95094/4 [==============================] - 2s 610ms/step - loss: 46.9509
Epoch 5/5
1/4 [======>.......................] - ETA: 1s - loss: 86.41942/4 [==============>...............] - ETA: 1s - loss: 64.58623/4 [=====================>........] - ETA: 0s - loss: 44.18724/4 [==============================] - ETA: 0s - loss: 38.74194/4 [==============================] - 2s 607ms/step - loss: 38.7419
Preparing test data...
Test input shapes range: 1572 to 5368 atoms
Adaptive padding to 3000 atoms (actual max: 10737)
  Truncated structure 1 from 3000 to 3000 atoms
Test data shape: (2, 3000, 53)
Making predictions...
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 662ms/step
1/1 [==============================] - ETA: 0s - loss: 58.55461/1 [==============================] - 1s 713ms/step - loss: 58.5546

Results:
  Mean absolute difference: 43.858742
  Final evaluation loss: 58.554558
  Final training loss: 38.741920
Plot saved as 'training_results_10structures.png'

Training Summary (10 structures):
  Initial Loss: 58.823112
  Final Loss: 38.741920
  Loss Reduction: 34.14%
  Total Epochs: 5

======================================================================
TRAINING COMPLETED
======================================================================
Dataset size: 10 structures
Total runtime: 0.30 minutes
Average time per structure: 0.03 minutes
Final memory usage: 2.87 GB
Peak memory stayed within 16 GB limit

Final Results Summary:
  Physics weight 2e-06: Train loss 38.741920, Eval loss 58.554558, MAE 43.858742
Final system memory usage:
              total        used        free      shared  buff/cache   available
Mem:          251Gi       3.8Gi       240Gi       452Mi       6.6Gi       245Gi
Swap:         4.0Gi          0B       4.0Gi
Job completed at Tue Aug  5 19:25:15 PDT 2025
